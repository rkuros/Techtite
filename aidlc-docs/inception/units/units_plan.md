# ユニット分割計画

## 概要

`user_stories.md` の全ユーザーストーリー（9 Epic、78 ストーリー）を、並行して実装できる凝集性の高い作業ユニット（境界づけられたコンテキスト）に分割する。

---

## ステップ

- [x] **Step 1**: ユーザーストーリーの依存関係を分析し、ユニット分割案を決定する ✅ 承認済み
- [x] **Step 2**: Unit 1（アプリケーションシェル・プラットフォーム基盤）の .md ファイルを作成する
- [x] **Step 3**: Unit 2（マークダウンエディタ）の .md ファイルを作成する
- [x] **Step 4**: Unit 3（プロジェクト・ファイル管理）の .md ファイルを作成する
- [x] **Step 5**: Unit 4（ナレッジベース・コア）の .md ファイルを作成する
- [x] **Step 6**: Unit 5（セマンティック検索・RAG）の .md ファイルを作成する
- [x] **Step 7**: Unit 6（Git統合・透過的同期）の .md ファイルを作成する
- [x] **Step 8**: Unit 7（ターミナル・エージェントダッシュボード）の .md ファイルを作成する
- [x] **Step 9**: Unit 8（システム信頼性・アンビエントエージェント・セッションログ）の .md ファイルを作成する
- [x] **Step 10**: Unit 9（ガードレール・セキュリティ）の .md ファイルを作成する
- [x] **Step 11**: Unit 10（コンテンツ公開パイプライン）の .md ファイルを作成する

---

## Step 1: ユニット分割案

### 分割方針

各 Epic の凝集性とサブドメインの境界を分析し、質問への回答を反映した結果、以下の **10 ユニット**に分割する。

| Unit | ユニット名 | 対応するストーリー | 理由 |
|------|-----------|-------------------|------|
| 1 | アプリケーションシェル・プラットフォーム基盤 | US-1.1〜US-1.5 | Tauri/IPC/ウィンドウ管理は全機能の土台。独立した基盤チームが担当 |
| 2 | マークダウンエディタ | US-2.1〜US-2.7 | CodeMirror 6 ベースのエディタは独立したドメイン。専門性が高い |
| 3 | プロジェクト・ファイル管理 | US-3.1〜US-3.5 | ファイルエクスプローラ・ナビゲーションはエディタとは別の関心事 |
| 4 | ナレッジベース・コア | US-4.1〜US-4.11 | 内部リンク・バックリンク・タグ・全文検索・Graph View。Obsidian準拠のコアナレッジ管理 |
| 5 | セマンティック検索・RAG | US-4.12〜US-4.19 | ベクトルインデックス・Embedding・セマンティック検索は独立した技術スタック（ONNX Runtime, sqlite-vss等） |
| 6 | Git統合・透過的同期 | US-5.1〜US-5.12 | Git操作とバックグラウンド同期は独立したサブドメイン |
| 7 | ターミナル・エージェントダッシュボード | US-6.1〜US-6.9 | 組み込みターミナル・エージェントUI・ファイル連携。ユーザー向けエージェント操作の関心事 |
| 8 | システム信頼性・アンビエントエージェント・セッションログ | US-6.10〜US-6.12, US-7.1〜US-7.5 | システムレベルキャプチャ → アンビエントエージェント → セッションログ生成・閲覧の一貫したデータフロー |
| 9 | ガードレール・セキュリティ | US-6.13〜US-6.16 | コスト管理・ログローテーション・サンドボックス・認証情報保管。運用・セキュリティの横断的関心事 |
| 10 | コンテンツ公開パイプライン | US-8.1〜US-8.5, US-9.1〜US-9.4 | ブログ（Epic 8）とSNS（Epic 9）は「ログ→AI変換→レビュー→公開」の同一パターン |

### 質問事項

以下の分割判断についてご確認ください。

---

**[Question 1]** Epic 4（ナレッジベース）を「コア（US-4.1〜US-4.11: リンク・タグ・検索・Graph View）」と「RAG/セマンティック検索（US-4.12〜US-4.19）」の2ユニットに分割してよいですか？技術スタックが大きく異なる（フロントエンド中心 vs ONNX Runtime/sqlite-vss等のML基盤）ため分割を提案していますが、1ユニットにまとめる方が適切であれば変更します。

[Answer] Y

---

**[Question 2]** Epic 6（AIエージェント管理）を以下の3ユニットに分割してよいですか？
- **Unit 7**: ターミナル・エージェントダッシュボード（US-6.1〜US-6.9）— ユーザー向けUI
- **Unit 8**: システム信頼性・アンビエントエージェント（US-6.10〜US-6.12）— バックグラウンド監視
- **Unit 9**: ガードレール・セキュリティ（US-6.13〜US-6.16）— 横断的運用・セキュリティ

1つまたは2つにまとめた方がよい場合はご指示ください。

[Answer] OK

---

**[Question 3]** Epic 8（ブログ公開）と Epic 9（SNS連携）を1つの「コンテンツ公開パイプライン」ユニットとしてまとめてよいですか？両者は「ログ→AI変換→レビュー→外部公開」という同一パターンを共有しており、同一チームが担当するのが自然と考えます。分離した方がよい場合はご指示ください。

[Answer] OK

---

**[Question 4]** Epic 7（セッションログ）は US-6.10（システムレベルキャプチャ）と US-6.12（アンビエントエージェントのログ粒度管理）に強い依存があります。現在は独立ユニット（Unit 10）としていますが、Unit 8（システム信頼性・アンビエントエージェント）に統合した方がよいですか？

[Answer] 統合して

---
